---
sidebar_position: 5
title: Remote host onboarding with Elemental
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## What is Elemental?

Elemental is a software stack that provides for remote control over the lifecycles of the Operating System, Kubernetes, and workload in a secure and declarative way. 



## Why use this method

## High Level Architecture

TODO: Draw image 

## Resources Needed

At the very least, you need:
- A host for the "upstream" cluster (the one hosting Rancher and Elemental) with: 
  - Minimum 8GB RAM and 20GB disk space for development or testing
  - For production use: See https://ranchermanager.docs.rancher.com/pages-for-subheaders/installation-requirements#hardware-requirements
- A host to be controlled
  - Could be physical device or Virtual Machine
  - Minimum 25GB disk
- A resolvable hostname
  - Or static ip address to use with a service like sslip.io 
- A host to build the installation media with
  - TODO: What are the requirements for this?
- A USB flash drive to boot from
  - Existing will be overwritten as part of the process

In the writing of this guide, I will be using a Digital Ocean droplet to host the upstream cluster and an Intel NUC as the downstream device. For building the installation media, I will be using my desktop running [openSUSE Tumbleweed](https://get.opensuse.org/tumbleweed/).

## How to Use Elemental

The basic steps to install and use Elemental are:

- Build bootstrap cluster 
- Install Rancher
- Install Elemental Operator and Rancher UI Extension
- Build installer disk 
- Boot device with installer
- Create downstream cluster

TODO: Record video and embed 

### Build Bootstrap Cluster

The first thing we need to do is create a cluster that can host Rancher and Elemental. This cluster needs to be routable from the network that the downstream nodes are connected to. 

TODO: make prose
- Create Kubernetes Cluster 
- Install Rancher
- Install Elemental
- (Optionally) Install Elemental UI

#### Create Kubernetes Cluster

If you are using a hyperscaler (such as Azure, AWS, or Google Cloud), it's likely easiest to set up a cluster using their built in tooling. For the sake of conciseness in this guide, we will not be detailing the process of each of these options.

If you are installing onto bare metal or another hosting service where you providing the Kubernetes distribution itself, we recommend using [RKE2](https://docs.rke2.io/install/quickstart). 

TODO: Should I add more detail?

#### Setup DNS

As with the setup of the cluster itself, how you configure DNS will be different depending on where it's being hosted.

If you don't want to deal with setting up DNS (for example this is just an ephemeral test server), you can use a service like [sslip.io](https://sslip.io). With this, you can take you  

#### Install Rancher

To install Rancher, you need to get access to the kubeapi of the cluster you just created. This looks differently depending on what distribution of Kubernetes is being used. 

You will also need to install the [kubectl](https://kubernetes.io/docs/reference/kubectl/kubectl/) and [helm](https://helm.sh) tools.

For RKE2,the kubeconfig file will have been written to `/etc/rancher/rke2/rke2.yaml`. You may need to edit the file to include the correct externally routable IP address or hostname. 

TODO: actually install Rancher

#### Install Elemental

#### Optionally Install the Elemental UI Plugin

#### Configure Elemental


### Build installation media

While the current version of Elemental (at time of writing) does have a way to build it's own installation media, we need to do this with the Edge Image Builder instead so the resulting system is built with [SLE Micro](https://www.suse.com/products/micro/) as the base Operating System. 

:::tip
For more details on the Edge Image Builder, you can check out the [Getting Started Guide for it](/docs/quickstart/eib). Or, for a more full discussion on it's capabilities there is a [full page documenting it]. 
:::

TODO: write the simplest EIB flow possible here

If you are booting a physical device, we need to burn the image to a USB flash drive. This can be done with:

<Tabs>
  <TabItem value="linux" label="Linux" default>
    TODO: how to find sdX

    ```bash
    sudo dd if=/path/to/output.iso of=/dev/sdX
    ```
  </TabItem>
  <TabItem value="OSX" label="OS X">
    TODO: any difference? 
    
    ```bash
    sudo dd if=/path/to/output.iso of=/dev/sdX
    ```
  </TabItem>
  <TabItem value="windows" label="Windows">
    TODO: ???
  </TabItem>
</Tabs>

### Boot downstream nodes

Now that we have the installation media created, we can boot our downstream nodes with it.

For each of the systems that you want to control with Elemental, install 


### Create downstream clusters

Now that Elemental can see and control our downstream machines, we can create a cluster from those machine

<Tabs>
  <TabItem value="yaml" label="YAML">
    
  </TabItem>
  <TabItem value="visual" label="UI Extension">

  </TabItem>
</Tabs>

## Next steps
TODO: prose

Some recommended next steps after using this guide are:

- Additional network configuration options (TODO: Link to right section in EIB)
- End to end automation with Fleet (TODO: Create page and link)
- TODO: ???

## Planned changes

There are a few changes to this that are currently planned (at time of writing):

#### Direct support for and integration with SLE Micro 6.x

TODO: write more about this

- Image building
- Both A/B and RPM based transactional updates
- UI improvements for non-teal images

This is expected to be included in the SUSE Edge 3.1 

## Additional Resources

TODO: What additional resources should we link?